{% extends "layout.html" %}
{% load static %}
{% block content %}
<div class="container py-5">
  <h1 class="text-center mb-4 text-white fw-bold">MY TODO LIST</h1>
<div class="col-md-8 mx-auto my-5 p-4 shadow-lg bg-body-tertiary rounded ">
  <form id="todoForm" class="mb-4" method="post" action={% if todo %}
  '{% url "edit" todo.id %}'
  {% else %}
   '{% url "home" %}'
   {% endif %}
   >
   
    {% csrf_token %}
    <div class="mb-2">
      <button class="btn">
        <img src={% static "icons/logout.svg" %} style="width:30px;" alt="Logout" data-bs-target="#logoutModal"
        data-bs-toggle="modal"
        >
      </button>
      <div
        class="modal fade"
        id="logoutModal"
        tabindex="-1"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5">Alert!</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              Are you sure you want to Logout? 
            </div> 
            <div class="modal-footer">
              <button type="button" class="btn btn-success" focus data-bs-dismiss="modal" >Cancel</button>
              <a href='{% url "logout" %}'><button type="button" class="btn btn-danger">Logout</button></a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="input-group">
      <input type="text" name="title" value={% if todo %}
      "{{ todo.title }}"{%else%}""{% endif %} class="form-control" placeholder="Add new todo" required /> 
      <button type="submit" class="btn btn-primary"><img src={% static "icons/save.svg" %} style="width:30px;" alt="Save"></button>
    </div>
  </form>

  {% if todos %}
  <ul class="list-group">
    {% for todo in todos %}
    <li class="list-group-item d-flex flex-wrap align-items-center justify-content-around">
      <span class="text-justify w-auto mb-3"> {{todo.title}} </span>
      <div class="d-inline-block d-flex flex-wrap w-auto justify-content-center gap-2">
        <a href='{% url "edit" todo.id %}' class="btn btn-success"><img src={% static "icons/edit.svg" %} style="width:30px;" alt="Edit"></a>
        <button
          class="btn btn-danger"
          data-bs-toggle="modal"
          data-bs-target="#deleteModal"
        >
          <img src={% static "icons/delete.svg" %} style="width:30px;" alt="Delete">
        </button>
        <button
          class="btn btn-warning"
          data-bs-toggle="modal"
          data-bs-target="#completedModal"
        >
          <img src={% static "icons/complete.svg" %} style="width:30px;" alt="Mark as Completed">
        </button>
      </div>
      <div
        class="modal fade"
        id="deleteModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5">Alert!</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              Are you sure you want to delete this todo? 
            </div> 
            <div class="modal-footer">
              <button type="button" class="btn btn-success" focus data-bs-dismiss="modal" >Cancel</button>
              <a href='{% url "delete" todo.id %}'><button type="button" class="btn btn-danger">Delete</button></a>
            </div>
          </div>
        </div>
      </div>
      <div
        class="modal fade"
        id="completedModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5">Alert!</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              Mark <span class="fw-bold">{{todo.title}}</span> as completed?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-success" data-bs-dismiss="modal" >Cancel</button>
              <a href='{% url "mark" todo.id %}'><button type="button" class="btn btn-danger">Mark</button></a>
            </div>
          </div>
        </div>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <div class="alert p-3">No Todos to Show!</div>
  {% endif %}
</div>
</div>
{% endblock %}
